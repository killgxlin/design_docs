// test_server ---------------------------------------------------------------------------

network
    auth_list;
    online_list;
    
    net.init();
    uint32 acceptorid = net.start_accept(
	"127.0.0.1", 
	999, 
	[](msg_t msg_){
            auth_list.push_back(msg_);
        },
	[](client_t client_){
            online_list.insert(client_);
        },
	[](client_t client_){
            online_list.erase(client_);
        }
    );
    
    while (true) {
        net.update();
    }
    
    net.stop_accept(acceptorid);
    net.destroy();
// test_client ---------------------------------------------------------------------------
void test_client() {
    thread_group grp;
    for (int i=0; i<100; ++i) {
        grp.add([](){
            client_t cli;
            cli.init("127.0.0.1", 999);
            while (!cli.is_connected()) {
                cli.try_connect();
            }
            
            msg_t msg;
            cli.send(msg);
            while (cli.is_connected()) {
                msg_t msg = cli.recv();
                if (msg) {
                }
                msg_t msg_send;
                cli.send(msg_send);
                
                sleep(100);
            }
            cli.destroy();
        });
    }

    grp.all_join();
}
